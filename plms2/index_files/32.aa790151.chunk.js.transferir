(this["webpackJsonpsuperon-web-commerce"]=this["webpackJsonpsuperon-web-commerce"]||[]).push([[32],{333:function(t,e,a){"use strict";a.d(e,"a",(function(){return y}));var i=a(34),o=a(267),d=a(2),n=a(1),r=a.n(n),s=a(56),c=a(38),l=a(12),u=a(21),p=a(820),h=a(809),g=a(785),b=a(408),m=a(804),x=a(821),j=a(39),C=a(0),f=a(6);const A=9999999999,q=(t,e)=>t===e?"trash":"minus",O=t=>{let e=Number(t.replace(",",".")),a=isNaN(e)?0:e;return a>A&&(a=A),a};class v extends r.a.Component{constructor(t){super(t),this.renderLabelQuantidade=(t,e,a)=>{const{produto:o,theme:d,carrinho:n,fornecedorActive:r}=this.props,s={backgroundColor:"white",width:"20%",textAlign:"center",color:d.secondaryColor,...a.btn};return Object(f.jsxs)("span",{children:[Object(f.jsx)(p.a,{attached:"left",icon:q(t,o.labelunidade,o.granularidade),className:"control-product-quantity",style:s,disabled:n.loading,onClick:t=>this.handleClickQuantidade(t,i.UPDATE_DIRECTION.DEC,o)}),Object(f.jsxs)(p.a,{style:{backgroundColor:"white",width:"60%",margin:"unset",opacity:"1",boxShadow:"0 0 0 1px rgba(34,36,38,.15)",cursor:"default"},children:[t," ",e]}),Object(f.jsx)(p.a,{attached:"right",icon:"plus",className:"control-product-quantity",disabled:((o.maxporpedido>0||o.maximo_disponivel>0)&&r.tag.includes("enable-stock-control")?o.maxporpedido>0&&t>=o.maxporpedido||o.maximo_disponivel>0&&t>=o.maximo_disponivel:n.loading)||this.props.disabledAdd,style:s,onClick:t=>this.handleClickQuantidade(t,i.UPDATE_DIRECTION.INC,o)})]})},this.handleClickQuantidade=(t,e,a,i)=>{const{carrinho:o,usuario:{idcliente:n},confirmCarrinhoLoading:r}=this.props,s=d.get(a,"meta_info.tag","").includes("SOB_DEMANDA");if(!n&&s)return l.b.warn("Aten\xe7\xe3o, parar entrar em contato \xe9 necess\xe1rio estar logado em uma conta.");if(s)this.openChat(a);else{if(!0!==o.bloqueio_atendimento)return r(!0),this.props.handleClickQuantidade(t,e,a,i);this.setState({...this.state,showBloqueio:!0})}},this.openChat=t=>{const{chatOpenRoom:e,usuario:a,fornecedorActive:i,chatSetInputValue:o}=this.props,n=d.get(a,"idcliente",null),r=d.get(i,"idfornecedor",null),s=d.get(t,"nome","");Object(j.o)(i,[C.Vc.VENDAMAIS_WEB,C.Vc.VENDAMAIS_APP])&&(e(n,r,{sala:"IDCLI:".concat(n,":").concat(r),canal:"cliente",numpedido:null}),o("Ol\xe1! Preciso de mais informa\xe7\xf5es sobre o produto ".concat(s)))},this.sendFeedback=t=>{const e=d.get(t,"recomendacao.sessao_id",null),a=d.get(t,"recomendacao.visao","CART");e&&this.props.recomendacaoFeedback({sessao_id:e,item_id:d.get(t,"idproduto",""),acao:"ADDTOCART",visao:a})},this.state={quantidade:t.quantidade,showBloqueio:!1,utilizaAgrupador:!1,tagsAgrupadorCard:[]},this.renderLabelQuantidade=this.renderLabelQuantidade.bind(this),this.renderInputQuantidade=this.renderInputQuantidade.bind(this),this.handleManualInputQuantidade=this.handleManualInputQuantidade.bind(this)}componentDidMount(){this.handleManualInputQuantidade=this.handleManualInputQuantidade();const t=d.get(this.props.produto,"tags_card_produto",[]);t&&t.length>0&&this.setState({...this.state,utilizaAgrupador:!0,tagsAgrupadorCard:t.map((t=>{let e=this.props.carrinho.produtosSelecionados.find((e=>e.id==t.id));return e&&e.quantidade?{...t,quantidade:e.quantidade}:t}))}),d.get(this.props,"carrinho.loading")&&this.props.carrinhoLoading(!1)}componentDidUpdate(t){t.quantidade!==this.props.quantidade&&this.setState({quantidade:this.props.quantidade}),this.state.utilizaAgrupador&&t.carrinho.produtosSelecionados!==this.props.carrinho.produtosSelecionados&&this.setState({...this.state,tagsAgrupadorCard:this.state.tagsAgrupadorCard.map((t=>{let e=this.props.carrinho.produtosSelecionados.find((e=>e.id==t.id));return e&&e.quantidade?{...t,quantidade:e.quantidade}:{...t,quantidade:0}}))})}handleManualInputQuantidade(){const t=this.props;return d.debounce(((e,a)=>{let{produto:{maxporpedido:o,labelunidade:d,unidadecadastral:n,granularidade:r,maximo_disponivel:s},fornecedorActive:c}=t,u="object"===typeof a.value?O(a.value.quantidade.toString()):O(a.value);u=((t,e)=>{let a=t<e&&t>0?e:null;return a||e*Math.ceil(t/e)})(u,r),c.tag.includes("enable-stock-control")&&(o&&u>o&&o>0&&(this.setState({quantidade:o}),u=o,l.b.warn("Voc\xea s\xf3 pode adicionar ".concat(o," ").concat(d.toLowerCase()," ao pedido"))),s&&u>s&&s>0&&(this.setState({quantidade:s}),u=s,l.b.warn("Voc\xea s\xf3 pode adicionar ".concat(s," ").concat(d.toLowerCase()," ao pedido")))),t.handleClickQuantidade({},i.UPDATE_DIRECTION.SET,"object"===typeof a.value?a.value:t.produto,u),this.setState({quantidade:a.value}),this.props.handleChangeQuantidade()}),300)}renderInputQuantidade(t,e,a,o){let{produto:n,theme:r,carrinho:s,fornecedorActive:c,popupMaxQuantidade:l}=a;const u=d.debounce(((t,e)=>this.handleManualInputQuantidade(t,e)),2e3),x={backgroundColor:"white",textAlign:"center",justifyContent:"center",color:r.secondaryColor,...o.btn,fontSize:this.state.utilizaAgrupador?"1em":o.btn.fontSize},j={width:"26%",lineHeight:"1.4285em",borderLeft:"0px",marginLeft:"-1px",marginRight:"-1px",borderRadius:"unset",...o.qtd,fontSize:this.state.utilizaAgrupador?"0.85rem":o.qtd.fontSize},C=((n.maxporpedido>0||n.maximo_disponivel>0)&&c.tag.includes("enable-stock-control")?n.maxporpedido>0&&t>=n.maxporpedido||n.maximo_disponivel>0&&t>=n.maximo_disponivel:s.loading)||this.props.disabledAdd;return Object(f.jsx)(h.a.Group,{inline:!0,className:"adicionar-remover-produto-carrinho",style:{maxWidth:this.state.utilizaAgrupador?"380px":"unset"},children:Object(f.jsxs)(g.a,{onChange:(t,e)=>{let{produto:{unidadecadastral:i}}=a,o=O(e.value);(n.maxporpedido>0&&o>n.maxporpedido||n.maximo_disponivel>0&&o>n.maximo_disponivel)&&(o=n.maximo_disponivel>=n.maxporpedido?n.maximo_disponivel:n.maxporpedido),this.state.utilizaAgrupador?(this.setState({...this.state,tagsAgrupadorCard:this.state.tagsAgrupadorCard.map((t=>t.idtagpesquisa==n.idtagpesquisa?{...t,quantidade:o}:t))}),e.value={...n,quantidade:o},u(t,e)):(this.setState({quantidade:o}),u(t,e))},style:{width:"100%",justifyContent:"center",height:this.state.utilizaAgrupador?"34px":""},placeholder:"0",value:this.state.utilizaAgrupador?t:this.state.quantidade,children:[this.state.utilizaAgrupador?Object(f.jsx)(p.a,{attached:"left",className:"control-product-quantity",style:{...x,padding:"0.78571429em 0.6em 0.78571429em",width:"160px",maxWidth:"160px",overflow:"hidden"},disabled:s.loading,onClick:t=>{this.handleClickQuantidade(t,i.UPDATE_DIRECTION.DEC,n)},children:Object(f.jsxs)("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[this.state.utilizaAgrupador&&Object(f.jsx)("span",{style:{maxWidth:"100%",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},children:n.descricao_tagpesquisa}),Object(f.jsx)(b.a,{name:q(t,n.labelunidade,n.granularidade)})]})}):Object(f.jsx)(p.a,{attached:"left",icon:q(t,n.labelunidade,n.granularidade),className:"control-product-quantity",style:x,disabled:s.loading,onClick:t=>this.handleClickQuantidade(t,i.UPDATE_DIRECTION.DEC,n)}),Object(f.jsx)("input",{style:{maxWidth:"37%",borderRightWidth:"0",textAlign:"right",zIndex:"2",...o.qtd},disabled:(n.maxporpedido>0||n.maximo_disponivel>0)&&c.tag.includes("enable-stock-control")?n.maxporpedido>0&&t>=n.maxporpedido||n.maximo_disponivel>0&&t>=n.maximo_disponivel:s.loading,type:"tel"}),Object(f.jsx)("div",{className:"ui basic label label",style:j,children:e}),Object(f.jsx)(m.a,{position:"top center",trigger:Object(f.jsx)("div",{children:Object(f.jsx)(p.a,{attached:"right",icon:"plus",className:"control-product-quantity",disabled:C,style:{...x,height:"100%"},onClick:t=>{this.handleClickQuantidade(t,i.UPDATE_DIRECTION.INC,n)}})}),children:l&&C&&Object(f.jsx)("div",{style:{padding:"10px",background:"#EEEEEE",borderRadius:".35rem",fontWeight:500,border:"1px solid rgba(0, 0, 0, 0.15)"},children:"Voc\xea atingiu a quantidade m\xe1xima permitida."})})]})})}renderTagsSelector(t){const{styles:e,carrinho:a}=this.props,o=d.get(e,"btn_adicionar")||{},n=t=>t.quantidade>0,r=(t,e)=>{n(t)?(this.handleClickQuantidade(e,i.UPDATE_DIRECTION.SET,t,0),this.setState({...this.state,tagsAgrupadorCard:this.state.tagsAgrupadorCard.map((e=>e.idtagpesquisa==t.idtagpesquisa?{...e,quantidade:0}:e))})):(this.handleClickQuantidade(e,i.UPDATE_DIRECTION.INC,t),this.setState({...this.state,tagsAgrupadorCard:this.state.tagsAgrupadorCard.map((e=>e.idtagpesquisa==t.idtagpesquisa?{...e,quantidade:e.quantidade+1}:e))}),this.sendFeedback(t))};return Object(f.jsxs)("div",{className:"tags-card-produto",style:{justifyContent:"center",...e.tags_card_produto,display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:this.state.tagsAgrupadorCard.some((t=>n(t)))?"0px":"8px"},children:[this.state.tagsAgrupadorCard.map((e=>Object(f.jsx)("div",{"data-tooltip":e.disponivel?void 0:"Produto indisponi\u0301vel",children:Object(f.jsx)(p.a,{className:"tag-item",style:{display:"flex",flex:"0 1",border:"2px solid",padding:"6px",cursor:"pointer",backgroundColor:n(e)?o.backgroundColor:"#ffffff",borderColor:o.backgroundColor,color:n(e)?"#ffffff":o.backgroundColor,fontSize:o.fontSize,fontWeight:o.fontWeight,fontStyle:o.fontStyle},fluid:!0,disabled:a.loading||!e.disponivel||t,onClick:t=>r(e,t),children:e.descricao_tagpesquisa},e.idtagpesquisa)},e.idtagpesquisa))),this.state.tagsAgrupadorCard.map((t=>t.quantidade>0&&Object(f.jsx)("div",{style:{width:"100%"},children:this.props.allowEdit?this.renderInputQuantidade(t.quantidade,t.unidade,{...this.props,produto:t},{btn:o,qtd:d.get(e,"qtd_unidade")||{}}):this.renderLabelQuantidade},t.idtagpesquisa)))]})}render(){const{quantidade:t,produto:e,theme:a,styles:o,t:n,carrinho:r,goLogin:s,fornecedorActive:c,usuario:l}=this.props,{showBloqueio:u}=this.state,h={btn:d.get(o,"btn_adicionar")||{},qtd:d.get(o,"qtd_unidade")||{},btnDemanda:d.get(o,"btn_sob_demanda")||{}},g=l.authenticated,m=c.tag.includes("allow-login-option-in-product-card")&&!g,j=this.props.allowEdit?()=>this.renderInputQuantidade(this.state.quantidade,e.labelunidade,this.props,h):this.renderLabelQuantidade;let C={backgroundColor:"white",borderRadius:"3px",textAlign:"center",color:a.secondaryColor};const A=d.get(e,"meta_info.sem_estoque"),q=d.get(e,"meta_info.tag",""),O=q.includes("SOB_DEMANDA");if(q){const t=O?h.btnDemanda:h.btn;C={...C,...t}}return Object(f.jsxs)(f.Fragment,{children:[this.state.utilizaAgrupador&&this.renderTagsSelector(m),!m&&this.state.utilizaAgrupador&&!this.state.tagsAgrupadorCard.some((t=>t.quantidade>0))&&Object(f.jsx)(p.a,{attached:"right",fluid:!0,className:"control-product-quantity",style:C,disabled:!0,children:n("card.produto.btn.selecionar.tag")}),!this.state.utilizaAgrupador&&!A&&!t&&!m&&Object(f.jsx)(p.a,{attached:"right",fluid:!0,className:"control-product-quantity",style:C,disabled:r.loading||this.props.disabled,onClick:t=>{this.handleClickQuantidade(t,i.UPDATE_DIRECTION.INC,e,O),this.sendFeedback(e)},children:O?Object(f.jsxs)(f.Fragment,{children:[n("card.produto.btn.consultor"),Object(f.jsx)(b.a,{name:"chat",style:{paddingLeft:"15px"}})]}):n("card.produto.btn.adicionar.carrinho")}),m&&Object(f.jsx)(p.a,{attached:"right",fluid:!0,className:"control-product-quantity",style:C,disabled:r.loading,onClick:()=>s(),children:n("card.produto.btn.login.para.comprar")}),!this.state.utilizaAgrupador&&!A&&t>0&&!m&&j(t,e.labelunidade,h),Object(f.jsxs)(x.a,{open:u,style:{margin:"100px auto",marginTop:"100px"},children:[Object(f.jsx)(x.a.Header,{children:Object(f.jsx)("p",{children:n("carrinho.bloqueio_atendimento.titulo")})}),Object(f.jsxs)(x.a.Content,{children:[Object(f.jsx)("p",{children:n("carrinho.bloqueio_atendimento.texto")}),Object(f.jsxs)("p",{style:{display:"flex",justifyContent:"flex-end"},children:[Object(f.jsx)(p.a,{onClick:()=>this.setState({...this.state,showBloqueio:!1}),children:"Cancelar"}),Object(f.jsx)(p.a,{onClick:()=>{this.props.forcaDesbloqueioAtendimento(),this.setState({...this.state,showBloqueio:!1})},style:{backgroundColor:a.primaryColor,color:a.textColor},children:n("carrinho.bloqueio_atendimento.btn_desbloqueio")})]})]})]})]})}}const y=Object(u.compose)(Object(o.b)("AdicionarRemoverProdutoCarrinho"),Object(s.b)(),Object(c.b)((t=>({carrinho:{...t.carrinho,loading:t.carrinho.loading||!1,loadingConfirm:t.carrinho.loadingConfirm||!1},usuario:t.usuario,fornecedorActive:t.fornecedor.fornecedorActive,chat:t.chat})),(t=>Object(u.bindActionCreators)({carrinhoLoading:i.carrinhoLoading,forcaDesbloqueioAtendimento:i.forcaDesbloqueioAtendimento,recomendacaoFeedback:i.recomendacaoFeedback,chatOpenRoom:i.chatOpenRoom,chatSetInputValue:i.chatSetInputValue,confirmCarrinhoLoading:i.confirmCarrinhoLoading},t))))(v)},487:function(t,e,a){"use strict";a.r(e),a.d(e,"CardProduto",(function(){return C}));var i=a(1),o=a(815),d=a(493),n=a(21),r=a(267),s=a(333),c=a(351),l=a(310),u=a(2),p=a(393),h=a(39),g=a(0),b=a(273),m=a.n(b),x=a(6);class j extends i.Component{constructor(t){super(t),this.state={seedAdicionarRemover:Math.random()},this._renderControles=this._renderControles.bind(this)}resolveProductImage(t){return Object(x.jsx)(l.a,{clickable:!0,size:"small",productId:t,lazy:!0})}_renderControles(t){let e=this.props.carrinho?this.props.carrinho.quantidade:0;const a={...this.props.produto,...this.props.precoDestaque},{fornecedorActive:i}=this.props;return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return!!(t&&t.length>0)&&Object(h.o)(i,t)}([g.Vc.ORCAMENTO_WEB,g.Vc.WEB_COMMERCE])?u.get(a,"meta_info.sem_estoque",!1)?Object(x.jsx)(p.a,{styles:t,idproduto:u.get(a,"idproduto"),actived:u.get(a,"alerta_disponibilidade",!1),idcadastroextraproduto:u.get(a,"idcadastroextraproduto")}):Object(x.jsx)(o.a.Content,{extra:!0,style:{textAlign:"center",paddingLeft:"6px",paddingRight:"6px"},children:Object(x.jsx)(s.a,{styles:t,quantidade:e,produto:a,allowEdit:this.props.allowEdit,handleClickQuantidade:this.props.handleClickQuantidade,goLogin:this.props.goLogin,handleChangeQuantidade:()=>{this.setState({seedAdicionarRemover:Math.random()})}},this.state.seedAdicionarRemover)}):Object(x.jsx)("div",{})}renderBadgeDesconto(t){const e=u.get(t,"efeitospoliticas.desconto.label"),a=u.get(t,"efeitospoliticas.desconto.colorName");return e?Object(x.jsx)(d.a,{as:"div",color:a,ribbon:!0,style:{width:"40%",marginLeft:"11px",transform:"scale(0.9)"},children:e}):null}render(){const t={...this.props.produto,...this.props.precoDestaque},{clickable:e,styles:a,fornecedorActive:i}=this.props;let d=this.props.carrinho?this.props.carrinho.quantidade:0,n=this.props.onNavigationDetails?"pointer":"auto",r=this.props.hover?"hoverCard":"";const s={fontSize:"16px",minHeight:"40px",textAlign:"center",marginTop:"10px",...a.nome_produto};return Object(x.jsxs)(o.a,{id:t.slug||t.idproduto,className:r,style:{textAlign:"center",marginLeft:"auto",marginRight:"auto"},children:[Object(x.jsx)(o.a.Header,{style:{padding:"14px",paddingTop:"5px",cursor:n},children:Object(x.jsx)("center",{style:{opacity:.7,textAlign:"left"},onClick:()=>this.props.onNavigationDetails(),children:Object(x.jsx)("div",{style:s,children:Object(x.jsx)(m.a,{escapeHtml:!1,source:t.nome})})})}),this.renderBadgeDesconto(t),Object(x.jsxs)(o.a.Content,{style:{borderTop:"0px",marginTop:"-10px",cursor:n},onClick:()=>this.props.onNavigationDetails(),children:[this.resolveProductImage(t.id),Object(x.jsx)(c.a,{produto:t,styles:a,quantidade:d,centerMode:!0,style:{cursor:e?"cursor":""},fornecedor:i})]}),this._renderControles(a)]})}}const C=Object(n.compose)(Object(r.b)("CardProduto",{}))(j);e.default=C}}]);